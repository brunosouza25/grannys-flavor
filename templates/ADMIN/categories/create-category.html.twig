<div class="col-lg-12">

    <div class="container">

        <div class="row" id="table_items">
            <div class="col-8">
                <label for="category_name">Nome</label>
                <input name="category_name" id="category_name" type="text" class="col-12">
            </div>

            <br>
            <div class="col-3 dark">
                <button class=" btn btn-primary"  id="create_new_category">Criar</button>
            </div>
            <br>
            <br>
            <br>
            <br>
            <div class="col-5">
                <label for="categoryParent">Categoria pai</label>
                <select name="categoryParent" id="categoryParent" class="col-12">
                    <option value="">Nenhum</option>
                    {% for item in categories %}
                        <option value="{{ item.id }}">{{ item.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <br>
            <br>
            <br>
            <br>
            <div class="col-12 row">
                <div role="tabpanel" class=" col-5 tab-pane fade show active" id="first">
                    <br>
                    <img class="img-fluid product-bo-image" src="/images/profile/noimagelist.png" id="imageAddNewProduct"
                         alt="no-photo">
                </div>
                <div class="col-7">
                    <label for="categoryDescription">Descrição</label>
                    <textarea class="col-12" name="categoryDescription" id="categoryDescription" cols="30" rows="10"></textarea>
                </div>

                <div class="input-group custom_file_input col-5">
                    <div class="form-file">
                        <input type="file" name="file"
                               class="form-file-input form-control" value="Upload"
                               multiple="multiple" id="image">
                    </div>
                </div>
            </div>
            <br>
        </div>
        <hr>

    </div>
</div>

<script>
    $(`#create_new_category`).click(function () {

        var fd = new FormData();
        var files = $('#image')[0].files;
        fd.append('categoryName', $(`#category_name`).val())
        fd.append('categoryDescription', $(`#categoryDescription`).val())
        fd.append('categoryParentId', $(`#categoryParent`).val())

        if(files.length > 0 ) {
            fd.append('file', files[0]);
        }

        $.ajax({
            url: `create_new_category`,
            type: 'POST',
            contentType: false,
            processData: false,
            data: fd,
            success: function () {
                $.alert({
                    title: 'Sucesso!',
                    content: 'Cadastrado com sucesso',
                });
                var tableCategories = document.getElementById('table_categories');
                loadingTablCategories('category', tableCategories)
                jconfirm.instances[1].close();

            }
        })
    });

    image.onchange = evt => {
        const [file] = image.files
        if (file) {
            imageAddNewProduct.src = URL.createObjectURL(file)
        }
    }
</script>